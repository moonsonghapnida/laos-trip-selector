<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë¹„ì—”í‹°ì•ˆ(1ë°•) ë£¨ì•™í”„ë¼ë°©(2ë°•) C-Pack ë¹ ë¥¸ê²¬ì </title>
  <meta name="viewport" content="width=480,user-scalable=no">
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <script>
    (function(){ emailjs.init('luKxEKdyyvY4hjYfo'); })();
  </script>
  <style>
    html { font-size:15px;}
    body { font-family: 'Pretendard', 'Noto Sans KR', Arial, sans-serif; background: #f7f7fa; margin: 0; padding: 0; color: #222; font-size:1rem;}
    .container { max-width: 880px; margin:32px auto; padding: 24px; background: #fff; border-radius: 18px; box-shadow: 0 2px 14px rgba(70, 85, 110, 0.12); }

    .form-grid { display: flex; flex-wrap: wrap; gap: 32px; }
    .form-col { flex: 1 1 0; min-width: 0; display: flex; flex-direction: column; gap: 0; }
    .form-col.left { min-width: 300px; flex-basis: 48%; }
    .form-col.right { min-width: 300px; flex-basis: 48%; }

    .section, .date-section, .result-section, .contact-section { margin-bottom: 24px; }
    h1 { font-size: 1.25rem; font-weight: bold; text-align: center; margin-bottom: 24px; color: #14508e; letter-spacing: -1px;}
    .result-section .result-title { font-size: 1.21em; font-weight: bold; color: #17508e; margin-bottom: 2px;}
    .result-section .result-desc { font-size: 0.95em; color: #989898; margin-bottom: 10px;}
    .result-section .result-big { font-size: 1.5em; font-weight: 700; color: #d02b2b; margin-left: 3px;}

    .section-label-row { display:flex; align-items:center; justify-content:space-between; margin-bottom:8px;}
    .section label { font-weight: 700; font-size: 1.01rem; color: #294a6b;}
    .person-desc { color:#b04d0c; font-size:0.95em; margin-top:5px; margin-bottom:-12px; font-weight:700;}
    .toggle-group { display: flex; gap: 7px; flex-wrap: wrap; margin-top: 7px;}
    .toggle-btn { background: #f4f7fb; border: 1.2px solid #c5d4ee; border-radius: 10px; padding: 10px 0 8px 0; font-size: 1.06em; flex: 1 1 0; text-align: center; cursor: pointer; margin-bottom: 6px; min-width: 42px; transition: all 0.12s; position: relative; font-weight:700;}
    .toggle-btn.selected { background: #296bb3; color: #fff; border-color: #14508e;}
    .toggle-btn[data-guide="kr"] span { color: #d02b2b !important; font-weight:700;}
    .toggle-btn.selected[data-guide="kr"] span { color: #fff !important; font-weight:700;}
    .option-list { margin-top: 6px;}
    .option-row { display: flex; align-items: center; justify-content: space-between; background:#f4f7fb; border:1px solid #d0deeb; border-radius:10px; padding: 11px 14px; margin-bottom: 7px; min-height:38px; font-size:1.07em; cursor:pointer; transition:background .18s, color .18s; font-weight:700; position:relative;}
    .option-row.selected { background: #296bb3; color: #fff; border-color: #14508e;}
    .option-title { font-size: 1.09em; flex:2;}
    .option-unit { flex:2; font-size: 1.04em; text-align:right; transition:color .15s; font-weight:700; display: flex; align-items: center; justify-content: flex-end; white-space: nowrap;}
    .option-row.selected .option-unit { color:#fff;}
    .option-row:not(.selected) .option-unit span { color: #17508e !important; font-weight:700;}
    .option-row.selected .option-unit span { color: #fff !important; }
    .option-minus-btn {
      background: #e9e7ff;
      color: #2857a3;
      border: 1px solid #bdd2ea;
      font-size: 1em;
      font-weight: 700;
      border-radius: 8px;
      padding: 4px 22px;
      margin-left:10px;
      cursor:pointer;
      box-shadow: 0 1px 5px #b9cbe833;
      white-space: nowrap;
      min-width: 54px;
      line-height: 1.5;
    }
    .option-row.selected .option-minus-btn { margin-left: 18px; }
    .option-minus-btn:active {background:#c9e2ff;}
    .room-total { margin-left:8px; color:#d02b2b; font-size:1em;}
    .total-label { color: #ffe400; margin-left:8px; font-size:1em;}
    .section .init-btn, .section .room-single-btn { font-weight:700;}
    .section-label-row { gap:10px;}
    .room-single-btn {background:#fff7e0; color:#b26c18; border:1px solid #edd59c; font-size:1em; border-radius:7px; padding:6px 16px; margin-right:7px; cursor:pointer;}
    .room-single-btn:active {background:#ffeec4;}
    .init-btn { font-size:1em; background:#e5eefe; border:1px solid #bdd2ea; border-radius:8px; color:#347; padding:6px 15px; cursor:pointer; margin-left:0;}
    .init-btn:hover {background:#d1e8ff;}
    .result-section { margin: 20px 0 17px 0; padding: 13px 7px 8px 7px; background: #f4f6fa; border-radius: 12px; text-align: center; font-size: 1.07em; color: #14508e; font-weight: 600;}
    .contact-section { margin-bottom: 20px; background: #f9fafb; border-radius: 12px; padding: 12px 8px 7px 8px;}
    .contact-label { display: block; margin: 10px 0 5px 2px; color: #37629d; font-size: 1.06em; font-weight: 700;}
    .contact-input { width: 100%; padding: 8px 8px; border: 1px solid #bfd2e9; border-radius: 8px; font-size: 1.02em; margin-bottom: 3px; box-sizing: border-box; background: #f7fafc; font-family: 'Pretendard', 'Noto Sans KR', Arial, sans-serif; font-weight:700;}
    textarea.contact-input { font-family: 'Pretendard', 'Noto Sans KR', Arial, sans-serif !important; resize: vertical;}
    .submit-btn { display: block; width: 100%; background: linear-gradient(90deg, #1466b6 88%, #25a6d1 100%); color: #fff; border: none; border-radius: 12px; padding: 15px 0; font-size: 1.12em; font-weight: 800; margin-top: 22px; cursor: pointer; transition: background 0.15s; letter-spacing: 0.5px; box-shadow: 0 2px 10px #4176a72c;}
    .submit-btn:active { background: #2a8ad1;}
    .date-section {margin-bottom:22px;}
    .date-label {font-weight:700; color:#294a6b; font-size:1.14em; margin-bottom:10px; display:block;}
    .date-input-wrap {display:flex; align-items:center; background:#f4f7fb; border-radius:10px; border:1.2px solid #c5d4ee; padding:12px 13px;}
    .date-input {border:none; background:transparent; font-size:1.07em; color:#1849b9; flex:1; font-weight:700;}
    .date-input:focus {outline:none;}
    .date-icon {font-size:1.26em; color:#14508e; margin-right:9px;}
    @media (max-width: 900px) {
      .container { max-width: 99vw; padding: 7vw 2vw;}
      .form-grid { flex-direction: column; gap: 0;}
      .form-col.left, .form-col.right { flex-basis: 100%; min-width: 0;}
      .result-section .result-title { font-size: 1.35em;}
      .result-section .result-desc { font-size: 1.10em;}
      .result-section .result-big { font-size: 1.8em;}
      h1 {font-size: 1.38rem;}
      .section label, .contact-label, .date-label { font-size:1.23em;}
      .toggle-btn, .init-btn, .room-single-btn { font-size: 1.15em;}
      .option-row { font-size:1.16em; min-height:34px;}
      .contact-input { font-size:1.13em;}
    }
    @media (max-width: 700px) {
      .option-row.selected .option-unit {display:flex;align-items:center;justify-content:flex-end;}
      .option-row.selected .option-minus-btn {
        position: static; font-size:1.1em; padding:5px 18px;
        z-index:2;
      }
      .option-row.selected .option-unit span {
        flex:1;
      }
    }
  </style>
</head>
<body>
<div class="container" id="cpack-quickform">
  <h1>ë¹„ì—”í‹°ì•ˆ(1ë°•) - ë£¨ì•™í”„ë¼ë°©(2ë°•) C-Pack ë¹ ë¥¸ê²¬ì </h1>
  <div class="form-grid">
    <div class="form-col left">
      <div class="date-section">
        <label class="date-label" for="travelDate">ì—¬í–‰ì¼ì <span style="font-weight:400; color:#999; font-size:0.92em;">(ì¶œêµ­ì¼ ê¸°ì¤€, í•„ìˆ˜)</span></label>
        <div class="date-input-wrap">
          <span class="date-icon">ğŸ“…</span>
          <input type="date" id="travelDate" class="date-input" required>
        </div>
      </div>
      <div class="section">
        <label>ì—¬í–‰ì¸ì› <span style="font-weight:400; color:#999; font-size:0.92em;">(2~8ëª…, ì˜ˆì•½ê¸ˆ ì¸ë‹¹ 60,000ì›)</span></label>
        <div class="toggle-group" id="personToggleGroup"></div>
        <div class="person-desc">9ëª… ì´ìƒ ë‹¨ì²´ í• ì¸ ì ìš© ê°€ëŠ¥, <b>ê°œë³„ ë¬¸ì˜</b></div>
      </div>
      <div class="section">
        <label>ê°€ì´ë“œíŒ© <span style="font-weight:400; color:#999; font-size:0.92em;">(ë‹¨ì¼ ì„ íƒ)</span></label>
        <div class="toggle-group" id="guideToggleGroup">
          <div class="toggle-btn selected" data-guide="kr" data-price="220">í•œêµ­ì¸ ê°€ì´ë“œ<br><span style="font-size:0.91em;">$220/íŒ€</span></div>
          <div class="toggle-btn" data-guide="local" data-price="0">í˜„ì§€ì¸ ê°€ì´ë“œ<br><span style="font-size:0.91em; color:#55c;">ì¶”ê°€ìš”ê¸ˆ ì—†ìŒ</span></div>
        </div>
      </div>
       <label>ìˆ™ë°•íŒ©</label>
          <div>
            <button type="button" class="room-single-btn" onclick="addSingleRoom()">ì‹±ê¸€ë£¸ ì¶”ê°€</button>
            <button type="button" class="init-btn" onclick="resetSingleRoom()">ì´ˆê¸°í™”</button>
          </div>
        </div>
        <div class="option-list" id="roomList"></div>
      </div>
      <div class="section">
        <div class="section-label-row">
          <label>ì„ íƒê´€ê´‘ (ì¼€ì–´íŒ©)</label>
          <button type="button" class="init-btn" onclick="resetCare()">ì´ˆê¸°í™”</button>
        </div>
        <div class="option-list" id="careList"></div>
      </div>
    </div>
    <div class="form-col right">
      <div class="section">
        <div class="section-label-row">
         
      <div class="section">
        <div class="section-label-row">
          <label>ì„ íƒê´€ê´‘ (ë£¨ì•™í”„ë¼ë°©)</label>
          <button type="button" class="init-btn" onclick="resetLuang()">ì´ˆê¸°í™”</button>
        </div>
        <div class="option-list" id="luangList"></div>
      </div>
      <div class="result-section" id="resultSection">
         <div class="result-title">ë¹ ë¥¸ ê²¬ì  ê¸ˆì•¡</div>
          <div class="result-desc">(ì‹¤ì œ ê²¬ì ê³¼ ìƒì´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.)</div>
         ê³„ì•½ê¸ˆ+í˜¸í…” (í•œêµ­ì—ì„œ ì…ê¸ˆí•˜ì‹¤ ê¸ˆì•¡): 
    <span id="contractPrice" class="result-big"></span><br>
  ì”ê¸ˆ (í˜„ì§€ì—ì„œ ì§€ë¶ˆí•˜ì‹¤ ê¸ˆì•¡): 
    <span id="usdPrice" class="result-big"></span>
      </div>
      <div class="contact-section">
        <label class="contact-label" for="contactName">ëŒ€í‘œì ì„±í•¨ <span style="color:#d02b2b;">*</span></label>
        <input type="text" class="contact-input" id="contactName" placeholder="ëŒ€í‘œì ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" required>
        <label class="contact-label" for="contactPhone">ì—°ë½ ê°€ëŠ¥í•œ ë²ˆí˜¸ ë˜ëŠ” ì¹´ì¹´ì˜¤í†¡ ID <span style="color:#d02b2b;">*</span></label>
        <input type="text" class="contact-input" id="contactPhone" placeholder="íœ´ëŒ€í° ë²ˆí˜¸ ë˜ëŠ” ì¹´ì¹´ì˜¤í†¡ ID" required>
        <label class="contact-label" for="contactNote">ê¸°íƒ€ ìš”ì²­ ì‚¬í•­ (ì„ íƒ)</label>
        <textarea class="contact-input" id="contactNote" rows="2" placeholder="ì˜ˆ ) ì˜ˆì•½ ê´€ë ¨ íŠ¹ì´ì‚¬í•­, ì‹ë‹¨, ì„ íƒê´€ê´‘ì— ì—†ëŠ” ì¶”ê°€ í¬ë§ ì¼ì • ë“±"></textarea>
      </div>
      <button class="submit-btn" onclick="submitEstimate()">ë¹ ë¥¸ ê²¬ì  ë³´ë‚´ê¸°</button>
    </div>
  </div>
</div>
<script>
// ì˜µì…˜ ë°ì´í„°
const MAX_PERSON = 8;
const contractPerPerson = 60000;
const extraUsdByPerson = {8:145,7:156,6:170,5:190,4:221,3:271,2:371};
const careOptions = [
  {name: "ë² íŠ¸ë‚¨ì‹ ì´ë°œê´€ í’€ì½”ìŠ¤ (90ë¶„)", price: 30},
  {name: "ë¼ì˜¤ í—ˆë²Œ í…Œë¼í”¼", price: 40},
  {name: "ë¼ì˜¤ ì „í†µ ë§ˆì‚¬ì§€ (2ì‹œê°„)", price: 25},
  {name: "ë¼ì˜¤ ì „í†µ ë§ˆì‚¬ì§€ (1ì‹œê°„)", price: 13},
  {name: "ë¼ì˜¤ ì˜¤ì¼ ë§ˆì‚¬ì§€ (2ì‹œê°„)", price: 35},
  {name: "ë¼ì˜¤ ì˜¤ì¼ ë§ˆì‚¬ì§€ (1ì‹œê°„)", price: 20}
];
const luangOptions = [
  {name: "ë£¨ì•™ ê³¨ëª© ìì „ê±° íˆ¬ì–´", price: 20},
  {name: "ë£¨ì•™í”„ë¼ë°© ì¿ í‚¹í´ë˜ìŠ¤(ëŸ°ì¹˜)", price: 40},
  {name: "ë£¨ì•™í”„ë¼ë°© ì¿ í‚¹í´ë˜ìŠ¤ (ë””ë„ˆ)", price: 35},
  {name: "ë½•ë‚˜ë¬´ ì „í†µ ì¢…ì´ ê³µì˜ˆ ì²´í—˜", price: 15},
  {name: "ë¹¡ìš° ë§ˆì„ íˆ¬ì–´ (ë¹¡ìš° ë™êµ´ í¬í•¨)", price: 20}
];
const roomOptions = [
  {name: "5ì„±ê¸‰ 3ë°•", price: 300000},
  {name: "4ì„±ê¸‰ 3ë°•", price: 248000},
  {name: "ì œê°€ ì˜ˆì•½í• ê²Œìš”", price: 0}
];

// ì—¬í–‰ì¸ì›
const personToggleGroup = document.getElementById("personToggleGroup");
let personCount = 2;
for(let i=2; i<=MAX_PERSON; i++) {
  const btn = document.createElement("div");
  btn.className = "toggle-btn" + (i===2 ? " selected" : "");
  btn.innerText = i + "ëª…";
  btn.setAttribute('data-person', i);
  btn.onclick = function() {
    document.querySelectorAll("#personToggleGroup .toggle-btn").forEach(b=>b.classList.remove("selected"));
    btn.classList.add("selected");
    carePersons = carePersons.map((v,idx)=>careChecked[idx]?personCount:0);
    luangPersons = luangPersons.map((v,idx)=>luangChecked[idx]?personCount:0);
    personCount = i;
    updateRoomList();
    renderCareList();
    renderLuangList();
    updateTotal();
    sendHeightToParent();
  }
  personToggleGroup.appendChild(btn);
}

// ê°€ì´ë“œíŒ©
let guideType = "kr";
let guidePrice = 220;
document.querySelectorAll("#guideToggleGroup .toggle-btn").forEach(btn=>{
  btn.onclick = function(){
    document.querySelectorAll("#guideToggleGroup .toggle-btn").forEach(b=>b.classList.remove("selected"));
    btn.classList.add("selected");
    guideType = btn.getAttribute('data-guide');
    guidePrice = Number(btn.getAttribute('data-price'));
    updateTotal();
    sendHeightToParent();
  }
});

// ===== ì„ íƒê´€ê´‘(ì¼€ì–´íŒ©) =====
const careList = document.getElementById("careList");
let careChecked = Array(careOptions.length).fill(false);
let carePersons = Array(careOptions.length).fill(0);
function renderCareList() {
  careList.innerHTML = "";
  careOptions.forEach((opt, idx) => {
    const row = document.createElement("div");
    row.className = "option-row" + (careChecked[idx] ? " selected" : "");
    row.style.cursor = "pointer";
    row.onclick = function(){
      careChecked[idx] = !careChecked[idx];
      carePersons[idx] = careChecked[idx] ? personCount : 0;
      renderCareList();
      updateTotal();
      sendHeightToParent();
    };
    const title = document.createElement("div");
    title.className = "option-title";
    title.innerText = opt.name;
    row.appendChild(title);

    const unit = document.createElement("div");
    unit.className = "option-unit";
    if(careChecked[idx]) {
      unit.innerHTML = `<span>$${carePersons[idx]*opt.price} / ${carePersons[idx]}ëª…</span>`;
      const minusBtn = document.createElement("button");
      minusBtn.type = "button";
      minusBtn.className = "option-minus-btn";
      minusBtn.innerText = "-1ëª…";
      minusBtn.onclick = function(e){
        carePersons[idx] = Math.max(0, carePersons[idx]-1);
        if(carePersons[idx]===0) {
          careChecked[idx]=false;
        }
        renderCareList();
        updateTotal();
        sendHeightToParent();
        e.stopPropagation();
      };
      unit.appendChild(minusBtn);
    } else {
      unit.innerHTML = `<span>$${opt.price}/ì¸ë‹¹</span>`;
    }
    row.appendChild(unit);
    careList.appendChild(row);
  });
}
window.resetCare = function(){
  careChecked = careChecked.map(()=>false);
  carePersons = carePersons.map(()=>0);
  renderCareList();
  updateTotal();
  sendHeightToParent();
}

// ===== ì„ íƒê´€ê´‘(ë£¨ì•™í”„ë¼ë°©) =====
const luangList = document.getElementById("luangList");
let luangChecked = Array(luangOptions.length).fill(false);
let luangPersons = Array(luangOptions.length).fill(0);
function renderLuangList() {
  luangList.innerHTML = "";
  luangOptions.forEach((opt, idx) => {
    const row = document.createElement("div");
    row.className = "option-row" + (luangChecked[idx] ? " selected" : "");
    row.style.cursor = "pointer";
    row.onclick = function(){
      luangChecked[idx] = !luangChecked[idx];
      luangPersons[idx] = luangChecked[idx] ? personCount : 0;
      renderLuangList();
      updateTotal();
      sendHeightToParent();
    };
    const title = document.createElement("div");
    title.className = "option-title";
    title.innerText = opt.name;
    row.appendChild(title);

    const unit = document.createElement("div");
    unit.className = "option-unit";
    if(luangChecked[idx]) {
      unit.innerHTML = `<span>$${luangPersons[idx]*opt.price} / ${luangPersons[idx]}ëª…</span>`;
      const minusBtn = document.createElement("button");
      minusBtn.type = "button";
      minusBtn.className = "option-minus-btn";
      minusBtn.innerText = "-1ëª…";
      minusBtn.onclick = function(e){
        luangPersons[idx] = Math.max(0, luangPersons[idx]-1);
        if(luangPersons[idx]===0) {
          luangChecked[idx]=false;
        }
        renderLuangList();
        updateTotal();
        sendHeightToParent();
        e.stopPropagation();
      };
      unit.appendChild(minusBtn);
    } else {
      unit.innerHTML = `<span>$${opt.price}/ì¸ë‹¹</span>`;
    }
    row.appendChild(unit);
    luangList.appendChild(row);
  });
}
window.resetLuang = function(){
  luangChecked = luangChecked.map(()=>false);
  luangPersons = luangPersons.map(()=>0);
  renderLuangList();
  updateTotal();
  sendHeightToParent();
}

// ===== ìˆ™ë°•íŒ© =====
const roomList = document.getElementById("roomList");
let selectedRoomIdx = null;
let singleRoomAdd = 0;
function updateRoomList(){
  roomList.innerHTML = "";
  let baseRoomCnt = Math.ceil(personCount/2);
  let totalRooms = baseRoomCnt + singleRoomAdd;
  roomOptions.forEach((opt, idx) => {
    const row = document.createElement("div");
    row.className = "option-row" + (selectedRoomIdx === idx ? " selected" : "");
    row.style.cursor = "pointer";
    row.onclick = function(){
      if(selectedRoomIdx === idx){
        selectedRoomIdx = null;
      } else {
        selectedRoomIdx = idx;
      }
      updateRoomList();
      updateTotal();
      sendHeightToParent();
    };
    const title = document.createElement("div");
    title.className = "option-title";
    title.innerText = opt.name;
    row.appendChild(title);

    const unit = document.createElement("div");
    unit.className = "option-unit";
    if(selectedRoomIdx === idx) {
      if(opt.price === 0) {
        unit.innerHTML = `<span>0ì›</span>`;
      } else {
        unit.innerHTML = `<span>${(totalRooms*opt.price).toLocaleString()}ì› / ${totalRooms}ë°©</span>`;
        const minusBtn = document.createElement("button");
        minusBtn.type = "button";
        minusBtn.className = "option-minus-btn";
        minusBtn.innerText = "-1ë°©";
        minusBtn.onclick = function(e){
          if(singleRoomAdd > 0){
            singleRoomAdd -= 1;
            updateRoomList();
            updateTotal();
            sendHeightToParent();
          }
          e.stopPropagation();
        };
        unit.appendChild(minusBtn);
      }
    } else {
      if(opt.price === 0){
        unit.innerHTML = `<span>0ì›</span>`;
      } else {
        unit.innerHTML = `<span>${opt.price.toLocaleString()}ì›/ë°©</span>`;
      }
    }
    row.appendChild(unit);
    roomList.appendChild(row);
  });
}
window.addSingleRoom = function(){
  singleRoomAdd += 1;
  updateRoomList();
  updateTotal();
  sendHeightToParent();
}
window.resetSingleRoom = function(){
  singleRoomAdd = 0;
  selectedRoomIdx = null;
  updateRoomList();
  updateTotal();
  sendHeightToParent();
}

// ê²¬ì  ê³„ì‚°
function updateTotal(){
  let contract = personCount * contractPerPerson;
  let baseRoomCnt = Math.ceil(personCount/2);
  let totalRooms = baseRoomCnt + singleRoomAdd;
  let roomPrice = (selectedRoomIdx !== null) ? roomOptions[selectedRoomIdx].price : 0;
  if(selectedRoomIdx !== null && roomPrice>0) contract += totalRooms*roomPrice;
  let usd = 0;
  if(guideType==="kr") usd += 220;
  careOptions.forEach((opt, idx) => { usd += carePersons[idx]*opt.price; });
  luangOptions.forEach((opt, idx) => { usd += luangPersons[idx]*opt.price; });
  let extraUsd = extraUsdByPerson[personCount] ? extraUsdByPerson[personCount] * personCount : 0;
  usd = extraUsd;
  careOptions.forEach((opt, idx) => { usd += carePersons[idx]*opt.price; });
  luangOptions.forEach((opt, idx) => { usd += luangPersons[idx]*opt.price; });
  if(guideType==="kr") usd += 220;
  document.getElementById("contractPrice").innerText = contract.toLocaleString()+"ì›";
  document.getElementById("usdPrice").innerText = "$"+usd.toLocaleString();
}
renderCareList();
renderLuangList();
updateRoomList();
updateTotal();

// EmailJS ê²¬ì  ì „ì†¡
function submitEstimate() {
  const productTitle = document.querySelector("h1").innerText.trim();
  const travelDate = document.getElementById("travelDate").value.trim();
  if(!travelDate) { alert("ì—¬í–‰ì¼ìë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”."); document.getElementById("travelDate").focus(); return;}
  const name = document.getElementById("contactName").value.trim();
  const phone = document.getElementById("contactPhone").value.trim();
  const note = document.getElementById("contactNote").value.trim();
  if(!name) { alert("ëŒ€í‘œì ì„±í•¨ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."); document.getElementById("contactName").focus(); return;}
  if(!phone) { alert("ì—°ë½ ê°€ëŠ¥í•œ ë²ˆí˜¸ ë˜ëŠ” ì¹´ì¹´ì˜¤í†¡ IDë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”."); document.getElementById("contactPhone").focus(); return;}
  let persons = personCount + "ëª…";
  let guide = guideType === "kr" ? "í•œêµ­ì¸ ê°€ì´ë“œ ($220/íŒ€)" : "í˜„ì§€ì¸ ê°€ì´ë“œ (ì¶”ê°€ìš”ê¸ˆ ì—†ìŒ)";
  let careStr = careOptions.map((opt, i)=> carePersons[i]>0? `${opt.name} (${carePersons[i]}ëª…)`:'').filter(Boolean).join(', ') || 'ì—†ìŒ';
  let luangStr = luangOptions.map((opt, i)=> luangPersons[i]>0? `${opt.name} (${luangPersons[i]}ëª…)`:'').filter(Boolean).join(', ') || 'ì—†ìŒ';
  let baseRoomCnt = Math.ceil(personCount/2);
  let totalRooms = baseRoomCnt + singleRoomAdd;
  let roomStr = selectedRoomIdx!==null ? roomOptions[selectedRoomIdx].name : "ë¯¸ì„ íƒ";
  if(selectedRoomIdx!==null && roomOptions[selectedRoomIdx].price!==0) roomStr += ` (${totalRooms}ë°©)`;
  let contract = document.getElementById("contractPrice").innerText;
  let usd = document.getElementById("usdPrice").innerText;
  emailjs.send('service_e6uns2x', 'template_hhk1zot', {
    product_title: productTitle,
    travel_date: travelDate,
    name: name,
    phone: phone,
    persons: persons,
    guide: guide,
    care: careStr,
    luang: luangStr,
    room: roomStr,
    contract: contract,
    usd: usd,
    note: note
  }).then(function(response) {
    alert("ê²¬ì ì´ ì„±ê³µì ìœ¼ë¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤!");
  }, function(error) {
    alert("ê²¬ì  ì „ì†¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
  });
}

// iframe ìë™ ë†’ì´ parentë¡œ ì „ë‹¬
function sendHeightToParent() {
  if (window.parent !== window) {
    window.parent.postMessage({
      type: "iframe-resize",
      height: document.body.scrollHeight
    }, "*");
  }
}
window.addEventListener("load", sendHeightToParent);
window.addEventListener("resize", sendHeightToParent);
const observer = new MutationObserver(sendHeightToParent);
observer.observe(document.body, { childList: true, subtree: true, attributes: true });
</script>
</body>
</html>
