<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë¼ì˜¤ìŠ¤ ë¹„ì—”í‹°ì•ˆ(1ë°•) - ë°©ë¹„ì—¥ (2ë°•) C-Pack ë¹ ë¥¸ê²¬ì </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    html { font-size:15px;}
    body { font-family: 'Pretendard', 'Noto Sans KR', Arial, sans-serif; background: #f7f7fa; margin: 0; padding: 0; color: #222; font-size:1rem;}
    .container { max-width: 480px; margin: 32px auto; padding: 24px; background: #fff; border-radius: 18px; box-shadow: 0 2px 14px rgba(70, 85, 110, 0.12);}
    h1 { font-size: 1.15rem; font-weight: bold; text-align: center; margin-bottom: 24px; color: #14508e; letter-spacing: -1px;}
    .section { margin-bottom: 24px;}
    .section-label-row { display:flex; align-items:center; justify-content:space-between; margin-bottom:8px;}
    .section label { font-weight: 600; font-size: 0.98rem; color: #294a6b;}
    .person-desc { color:#b04d0c; font-size:0.85em; margin-top:5px; margin-bottom:-12px;}
    .toggle-group { display: flex; gap: 7px; flex-wrap: wrap; margin-top: 7px;}
    .toggle-btn { background: #f4f7fb; border: 1.2px solid #c5d4ee; border-radius: 10px; padding: 9px 0 7px 0; font-size: 1em; flex: 1 1 0; text-align: center; cursor: pointer; margin-bottom: 6px; min-width: 42px; transition: all 0.12s; position: relative;}
    .toggle-btn.selected { background: #296bb3; color: #fff; border-color: #14508e;}
    .option-list { margin-top: 6px;}
    .option-row { display: flex; align-items: center; justify-content: space-between; background:#f4f7fb; border:1px solid #d0deeb; border-radius:10px; padding: 7px 11px 6px 11px; margin-bottom: 7px; min-height:38px; font-size:0.97em; cursor:pointer; transition:background 0.13s, color 0.13s;}
    .option-row.selected { background: #296bb3; color: #fff;}
    .option-title { font-size: 0.97em; flex:2;}
    .option-unit { flex:1.4; font-size: 0.92em; color:#1849b9; text-align:center; transition:color .15s;}
    .option-row.selected .option-unit { color:#fff;}
    .option-total { flex:2.1; font-size: 0.95em; color:#d02b2b; font-weight:bold; text-align:right;}
    .option-row.selected .option-total { color: #ffe400; }
    .option-controls {display:flex; align-items:center; gap:7px;}
    .option-minus-btn {background:#e9e7ff; color:#2857a3; border:1px solid #bdd2ea; font-size:0.96em; border-radius:7px; padding:3px 8px; margin-right:4px; cursor:pointer;}
    .option-minus-btn:active {background:#c9e2ff;}
    .init-btn { font-size:0.92em; background:#e5eefe; border:1px solid #bdd2ea; border-radius:8px; color:#347; padding:4px 10px; cursor:pointer; margin-left:7px;}
    .init-btn:hover {background:#d1e8ff;}
    .room-single-btn {background:#fff7e0; color:#b26c18; border:1px solid #edd59c; font-size:0.92em; border-radius:7px; padding:4px 12px; margin-right:7px; cursor:pointer;}
    .room-single-btn:active {background:#ffeec4;}
    .result-section { margin: 20px 0 17px 0; padding: 13px 7px 8px 7px; background: #f4f6fa; border-radius: 12px; text-align: center; font-size: 1.05em; color: #14508e; font-weight: 600;}
    .result-section span { display: block; margin: 6px 0; font-weight: 500; color: #0c3d5a; font-size: 0.97em;}
    .contact-section { margin-bottom: 20px; background: #f9fafb; border-radius: 12px; padding: 12px 8px 7px 8px;}
    .contact-label { display: block; margin: 10px 0 5px 2px; color: #37629d; font-size: 0.96em; font-weight: 500;}
    .contact-input { width: 100%; padding: 8px 8px; border: 1px solid #bfd2e9; border-radius: 8px; font-size: 1em; margin-bottom: 3px; box-sizing: border-box; background: #f7fafc; font-family: 'Pretendard', 'Noto Sans KR', Arial, sans-serif; }
    textarea.contact-input { font-family: 'Pretendard', 'Noto Sans KR', Arial, sans-serif !important; resize: vertical;}
    .submit-btn { display: block; width: 100%; background: linear-gradient(90deg, #1466b6 88%, #25a6d1 100%); color: #fff; border: none; border-radius: 12px; padding: 13px 0; font-size: 1em; font-weight: 700; margin-top: 22px; cursor: pointer; transition: background 0.15s; letter-spacing: 0.5px; box-shadow: 0 2px 10px #4176a72c;}
    .submit-btn:active { background: #2a8ad1;}
    @media (max-width: 600px) {
      html {font-size:14px;}
      .container { max-width: 99vw; padding: 7vw 2vw;}
      .toggle-btn { font-size: 0.95em; min-width: 30px; padding: 8px 0 6px 0;}
      .option-row { font-size:0.93em; flex-direction:column; align-items:flex-start; gap:4px; padding: 7px 5px;}
      .option-unit, .option-total {text-align:left;}
      .init-btn {margin:6px 0 0 0; width:100%; text-align:center;}
      .room-single-btn {margin-bottom:7px;}
      .section-label-row {flex-direction:column; align-items:flex-start;gap:6px;}
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ë¼ì˜¤ìŠ¤ ë¹„ì—”í‹°ì•ˆ(1ë°•) - ë°©ë¹„ì—¥ (2ë°•) C-Pack ë¹ ë¥¸ê²¬ì </h1>
    <!-- ì—¬í–‰ì¼ì ì„ íƒ -->
    <div class="date-section">
      <label class="date-label" for="travelDate">ì—¬í–‰ì¼ì <span style="font-weight:400; color:#999; font-size:0.92em;">(ì¶œêµ­ì¼ ê¸°ì¤€, í•„ìˆ˜)</span></label>
      <div class="date-input-wrap">
        <span class="date-icon">ğŸ“…</span>
        <input type="date" id="travelDate" class="date-input" required>
      </div>
    </div>
    <!-- 1. ì—¬í–‰ì¸ì› -->
    <div class="section">
      <label>ì—¬í–‰ì¸ì› <span style="font-weight:400; color:#999; font-size:0.92em;">(2~8ëª…, ì˜ˆì•½ê¸ˆ ì¸ë‹¹ 60,000ì›)</span></label>
      <div class="toggle-group" id="personToggleGroup"></div>
      <div class="person-desc">9ëª… ì´ìƒ ë‹¨ì²´ í• ì¸ ì ìš© ê°€ëŠ¥, <b>ê°œë³„ ë¬¸ì˜</b></div>
    </div>
    <!-- 2. ê°€ì´ë“œíŒ© -->
    <div class="section">
      <label>ê°€ì´ë“œíŒ© <span style="font-weight:400; color:#999; font-size:0.92em;">(ë‹¨ì¼ ì„ íƒ)</span></label>
      <div class="toggle-group" id="guideToggleGroup">
        <div class="toggle-btn" data-guide="kr" data-price="220">í•œêµ­ì¸ ê°€ì´ë“œ<br><span style="font-size:0.91em; color:#55c;">$220/íŒ€</span></div>
        <div class="toggle-btn" data-guide="local" data-price="0">í˜„ì§€ì¸ ê°€ì´ë“œ<br><span style="font-size:0.91em; color:#55c;">ì¶”ê°€ìš”ê¸ˆ ì—†ìŒ</span></div>
      </div>
    </div>
    <!-- 3. ì„ íƒê´€ê´‘(ë°©ë¹„ì—¥) -->
    <div class="section">
      <div class="section-label-row">
        <label>ì„ íƒê´€ê´‘ (ë°©ë¹„ì—¥)</label>
        <button type="button" class="init-btn" onclick="resetVangvieng()">ì´ˆê¸°í™”</button>
      </div>
      <div class="option-list" id="vangviengList"></div>
    </div>
    <!-- 4. ì„ íƒê´€ê´‘(ì¼€ì–´íŒ©) -->
    <div class="section">
      <div class="section-label-row">
        <label>ì„ íƒê´€ê´‘ (ì¼€ì–´íŒ©)</label>
        <button type="button" class="init-btn" onclick="resetCare()">ì´ˆê¸°í™”</button>
      </div>
      <div class="option-list" id="careList"></div>
    </div>
    <!-- 5. ìˆ™ë°•íŒ© -->
    <div class="section">
      <div class="section-label-row">
        <label>ìˆ™ë°•íŒ©</label>
        <div>
          <button type="button" class="room-single-btn" onclick="addSingleRoom()">ì‹±ê¸€ë£¸ ì¶”ê°€</button>
          <button type="button" class="init-btn" onclick="resetSingleRoom()">ì´ˆê¸°í™”</button>
        </div>
      </div>
      <div class="option-list" id="roomList"></div>
    </div>
    <!-- ê²°ê³¼ ê²¬ì  -->
    <div class="result-section" id="resultSection">
      ê³„ì•½ê¸ˆ (í•œêµ­ì—ì„œ ì…ê¸ˆí•˜ì‹¤ ê¸ˆì•¡): <span id="contractPrice">0ì›</span>
      <br>
      ì”ê¸ˆ (í˜„ì§€ì—ì„œ ë‹¬ëŸ¬ ì§€ë¶ˆí•˜ì‹¤ ê¸ˆì•¡): <span id="usdPrice">$0</span>
    </div>
    <!-- ì—°ë½ì²˜ ì •ë³´ ì…ë ¥ë€ -->
    <div class="contact-section">
      <label class="contact-label" for="contactName">ëŒ€í‘œì ì„±í•¨ <span style="color:#d02b2b;">*</span></label>
      <input type="text" class="contact-input" id="contactName" placeholder="ëŒ€í‘œì ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" required>
      <label class="contact-label" for="contactPhone">ì—°ë½ ê°€ëŠ¥í•œ ë²ˆí˜¸ ë˜ëŠ” ì¹´ì¹´ì˜¤í†¡ ID <span style="color:#d02b2b;">*</span></label>
      <input type="text" class="contact-input" id="contactPhone" placeholder="íœ´ëŒ€í° ë²ˆí˜¸ ë˜ëŠ” ì¹´ì¹´ì˜¤í†¡ ID" required>
      <label class="contact-label" for="contactNote">ê¸°íƒ€ ìš”ì²­ ì‚¬í•­ (ì„ íƒ)</label>
      <textarea class="contact-input" id="contactNote" rows="2" placeholder="ì˜ˆ ) ì˜ˆì•½ ê´€ë ¨ íŠ¹ì´ì‚¬í•­, ì‹ë‹¨, ì„ íƒê´€ê´‘ì— ì—†ëŠ” ì¶”ê°€ í¬ë§ ì¼ì • ë“±"></textarea>
    </div>
    <button class="submit-btn" onclick="submitEstimate()">ë¹ ë¥¸ ê²¬ì  ë³´ë‚´ê¸°</button>
  </div>
  <script>
    // ì˜µì…˜ ë°ì´í„° ë° ìƒíƒœë³€ìˆ˜
    const vangviengOptions = [
      {name: "ì—´ê¸°êµ¬", price: 100},
      {name: "í˜ëŸ¬ëª¨í„°", price: 85},
      {name: "ë²„ê¸°ì¹´", price: 18},
      {name: "ì§šë¼ì¸", price: 20},
      {name: "ë¡±í…Œì¼ë³´íŠ¸", price: 10},
      {name: "ì‹œí¬ë¦¿ë¼êµ°", price: 10}
    ];
    const careOptions = [
      {name: "ë² íŠ¸ë‚¨ì‹ ì´ë°œê´€ í’€ì½”ìŠ¤ (90ë¶„)", price: 30},
      {name: "ë¼ì˜¤ í—ˆë²Œ í…Œë¼í”¼", price: 40},
      {name: "ë¼ì˜¤ ì „í†µ ë§ˆì‚¬ì§€ (2ì‹œê°„)", price: 25},
      {name: "ë¼ì˜¤ ì „í†µ ë§ˆì‚¬ì§€ (1ì‹œê°„)", price: 13},
      {name: "ë¼ì˜¤ ì˜¤ì¼ ë§ˆì‚¬ì§€ (2ì‹œê°„)", price: 35},
      {name: "ë¼ì˜¤ ì˜¤ì¼ ë§ˆì‚¬ì§€ (1ì‹œê°„)", price: 20}
    ];
    const roomOptions = [
      {name: "5ì„±ê¸‰ 3ë°•", price: 255000},
      {name: "4ì„±ê¸‰ 3ë°•", price: 159000},
      {name: "ì œê°€ ì˜ˆì•½í• ê²Œìš”", price: 0}
    ];
    const MAX_PERSON = 8;
    const extraUsdByPerson = {8:95,7:105,6:118,5:137,4:165,3:211,2:305};
    let personCount = 2;

    // ì¸ì› ì„ íƒ
    const personToggleGroup = document.getElementById("personToggleGroup");
    for(let i=2; i<=MAX_PERSON; i++) {
      const btn = document.createElement("div");
      btn.className = "toggle-btn" + (i===2 ? " selected" : "");
      btn.innerText = i + "ëª…";
      btn.setAttribute('data-person', i);
      btn.onclick = function() {
        document.querySelectorAll("#personToggleGroup .toggle-btn").forEach(b=>b.classList.remove("selected"));
        btn.classList.add("selected");
        personCount = i;
        vangviengPersons = vangviengPersons.map((v,idx)=>vangviengChecked[idx]?personCount:0);
        carePersons = carePersons.map((v,idx)=>careChecked[idx]?personCount:0);
        updateRoomList();
        renderVangviengList();
        renderCareList();
        updateTotal();
        sendHeightToParent();
      }
      personToggleGroup.appendChild(btn);
    }

    // ê°€ì´ë“œíŒ©
    let guideType = "kr";
    let guidePrice = 220;
    document.querySelectorAll("#guideToggleGroup .toggle-btn").forEach(btn=>{
      btn.onclick = function(){
        document.querySelectorAll("#guideToggleGroup .toggle-btn").forEach(b=>b.classList.remove("selected"));
        btn.classList.add("selected");
        guideType = btn.getAttribute('data-guide');
        guidePrice = Number(btn.getAttribute('data-price'));
        updateTotal();
        sendHeightToParent();
      }
    });

    // ì„ íƒê´€ê´‘(ë°©ë¹„ì—¥)
    const vangviengList = document.getElementById("vangviengList");
    let vangviengChecked = Array(vangviengOptions.length).fill(false);
    let vangviengPersons = Array(vangviengOptions.length).fill(0);
    function renderVangviengList() {
      vangviengList.innerHTML = "";
      vangviengOptions.forEach((opt, idx) => {
        const row = document.createElement("div");
        row.className = "option-row" + (vangviengChecked[idx] ? " selected" : "");
        row.onclick = function(){
          vangviengChecked[idx] = !vangviengChecked[idx];
          vangviengPersons[idx] = vangviengChecked[idx] ? personCount : 0;
          renderVangviengList();
          updateTotal();
          sendHeightToParent();
        };
        const title = document.createElement("div");
        title.className = "option-title";
        title.innerText = opt.name;
        row.appendChild(title);
        const unit = document.createElement("div");
        unit.className = "option-unit";
        unit.innerText = vangviengChecked[idx] ? `$${opt.price} Ã— ${vangviengPersons[idx]}ëª… = $${vangviengPersons[idx]*opt.price}` : `$${opt.price}/ì¸ë‹¹`;
        row.appendChild(unit);
        const controls = document.createElement("div");
        controls.className = "option-controls";
        if(vangviengChecked[idx]) {
          const minusBtn = document.createElement("button");
          minusBtn.type = "button";
          minusBtn.className = "option-minus-btn";
          minusBtn.innerText = "-1ëª…";
          minusBtn.onclick = function(e){
            vangviengPersons[idx] = Math.max(0, vangviengPersons[idx]-1);
            if(vangviengPersons[idx]===0) vangviengChecked[idx]=false;
            renderVangviengList(); updateTotal(); sendHeightToParent();
            e.stopPropagation();
          };
          controls.appendChild(minusBtn);
          const total = document.createElement("div");
          total.className = "option-total";
          total.innerText = `$${vangviengPersons[idx]*opt.price} / ì´ ${vangviengPersons[idx]}ëª…`;
          controls.appendChild(total);
        }
        row.appendChild(controls);
        vangviengList.appendChild(row);
      });
    }
    window.resetVangvieng = function(){
      vangviengChecked = vangviengChecked.map(()=>false);
      vangviengPersons = vangviengPersons.map(()=>0);
      renderVangviengList(); updateTotal(); sendHeightToParent();
    }

    // ì„ íƒê´€ê´‘(ì¼€ì–´íŒ©)
    const careList = document.getElementById("careList");
    let careChecked = Array(careOptions.length).fill(false);
    let carePersons = Array(careOptions.length).fill(0);
    function renderCareList() {
      careList.innerHTML = "";
      careOptions.forEach((opt, idx) => {
        const row = document.createElement("div");
        row.className = "option-row" + (careChecked[idx] ? " selected" : "");
        row.onclick = function(){
          careChecked[idx] = !careChecked[idx];
          carePersons[idx] = careChecked[idx] ? personCount : 0;
          renderCareList(); updateTotal(); sendHeightToParent();
        };
        const title = document.createElement("div");
        title.className = "option-title";
        title.innerText = opt.name;
        row.appendChild(title);
        const unit = document.createElement("div");
        unit.className = "option-unit";
        unit.innerText = careChecked[idx] ? `$${opt.price} Ã— ${carePersons[idx]}ëª… = $${carePersons[idx]*opt.price}` : `$${opt.price}/ì¸ë‹¹`;
        row.appendChild(unit);
        const controls = document.createElement("div");
        controls.className = "option-controls";
        if(careChecked[idx]) {
          const minusBtn = document.createElement("button");
          minusBtn.type = "button";
          minusBtn.className = "option-minus-btn";
          minusBtn.innerText = "-1ëª…";
          minusBtn.onclick = function(e){
            carePersons[idx] = Math.max(0, carePersons[idx]-1);
            if(carePersons[idx]===0) careChecked[idx]=false;
            renderCareList(); updateTotal(); sendHeightToParent();
            e.stopPropagation();
          };
          controls.appendChild(minusBtn);
          const total = document.createElement("div");
          total.className = "option-total";
          total.innerText = `$${carePersons[idx]*opt.price} / ì´ ${carePersons[idx]}ëª…`;
          controls.appendChild(total);
        }
        row.appendChild(controls);
        careList.appendChild(row);
      });
    }
    window.resetCare = function(){
      careChecked = careChecked.map(()=>false);
      carePersons = carePersons.map(()=>0);
      renderCareList(); updateTotal(); sendHeightToParent();
    }

    // ìˆ™ë°•íŒ©
    const roomList = document.getElementById("roomList");
    let selectedRoomIdx = null;
    let singleRoomAdd = 0;
    function updateRoomList(){
      roomList.innerHTML = "";
      let baseRoomCnt = Math.ceil(personCount/2);
      let totalRooms = baseRoomCnt + singleRoomAdd;
      roomOptions.forEach((opt, idx) => {
        const row = document.createElement("div");
        row.className = "option-row" + (selectedRoomIdx === idx ? " selected" : "");
        row.onclick = function(){
          if(selectedRoomIdx === idx) selectedRoomIdx = null;
          else selectedRoomIdx = idx;
          updateRoomList(); updateTotal(); sendHeightToParent();
        };
        const title = document.createElement("div");
        title.className = "option-title";
        title.innerText = opt.name;
        const unit = document.createElement("div");
        unit.className = "option-unit";
        unit.innerText = opt.price===0 ? "0ì›" : `${opt.price.toLocaleString()}ì›/ê°ì‹¤`;
        const total = document.createElement("div");
        total.className = "option-total";
        total.innerText = opt.price===0 ? "0ì›" : `${(totalRooms*opt.price).toLocaleString()}ì› / ${totalRooms}ê°ì‹¤`;
        row.appendChild(title); row.appendChild(unit); row.appendChild(total);
        roomList.appendChild(row);
      });
    }
    window.addSingleRoom = function(){
      singleRoomAdd += 1; updateRoomList(); updateTotal(); sendHeightToParent();
    }
    window.resetSingleRoom = function(){
      singleRoomAdd = 0; selectedRoomIdx = null;
      updateRoomList(); updateTotal(); sendHeightToParent();
    }

    // ê²¬ì  ê³„ì‚°
    function updateTotal(){
      let contract = personCount * 60000;
      let baseRoomCnt = Math.ceil(personCount/2);
      let totalRooms = baseRoomCnt + singleRoomAdd;
      let roomPrice = (selectedRoomIdx !== null) ? roomOptions[selectedRoomIdx].price : 0;
      if(selectedRoomIdx !== null && roomPrice>0) contract += totalRooms*roomPrice;
      let usd = 0;
      if(guideType==="kr") usd += 220;
      vangviengOptions.forEach((opt, idx) => { usd += vangviengPersons[idx]*opt.price; });
      careOptions.forEach((opt, idx) => { usd += carePersons[idx]*opt.price; });
      let extraUsd = extraUsdByPerson[personCount] ? extraUsdByPerson[personCount] * personCount : 0;
      usd += extraUsd;
      document.getElementById("contractPrice").innerText = contract.toLocaleString()+"ì›";
      document.getElementById("usdPrice").innerText = "$"+usd.toLocaleString();
    }

    // ìµœì´ˆ ë Œë”ë§
    renderVangviengList();
    renderCareList();
    updateRoomList();
    updateTotal();

    // ê²¬ì  ì´ë©”ì¼ ì „ì†¡(ì—¬ê¸°ì„œëŠ” emailjs ë“± ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ í•„ìš”/ì´ë©”ì¼ ì§ì ‘ ë°œì†¡ì€ ë³„ë„ êµ¬í˜„)
    function submitEstimate() {
      alert("ë¹ ë¥¸ ê²¬ì  ë³´ë‚´ê¸°ëŠ” ê³§ ì§€ì›ë©ë‹ˆë‹¤. (ë³„ë„ ì´ë©”ì¼ ê¸°ëŠ¥ì„ ë¶™ì´ì„¸ìš”!)");
    }

    // iframe ìë™ ë†’ì´ ì „ì†¡
    let lastSentHeight = 0;
    function sendHeightToParent() {
      const height = document.body.scrollHeight;
      if (window.parent !== window && lastSentHeight !== height) {
        window.parent.postMessage({
          type: "iframe-resize",
          height: height
        }, "*");
        lastSentHeight = height;
      }
    }
    window.addEventListener("load", sendHeightToParent);
    window.addEventListener("resize", sendHeightToParent);
    const observer = new MutationObserver(sendHeightToParent);
    observer.observe(document.body, { childList: true, subtree: true, attributes: true });
  </script>
</body>
</html>
